{% extends "base.html" %}

{% block styles %}
    {{ super() }}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/sidenav.css') }}">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="{{ url_for('static', filename='js/d3_field.js') }}"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function(){

        setup_sprays();
        let spray_density = new field_density("field-density");
        let d_vals = {{ d_vals|tojson}};
        for(var i = 0; i < d_vals.length; i++){
            spray_density.set_position_shade(i, d_vals[i]);
        }
    });

    function setup_sprays(){
        let spray_legend = new field_legend("field-legend");
        let spray = new field("field");

        let hits = {{ sprays|tojson }};
        
        hits.forEach(function(hit){
            if(hit.x != null && hit.y !=null){
                spray.drawCircle(hit.x, hit.y, hit.traj, hit.hard_hit);
            }
        });
    }
    </script>
{% endblock %}

{% block app_content %}
    {% include "opponent/batter/batter_sidenav.html" %}
    <div class="main">
        <h1>
            {{batter.name()}} - Spray Charts
        </h1> 
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-md-6" id="spray-location">
                    <h4>Spray Locations</h4>
                    <div>
                        <div id="field-legend"></div>
                        <br>
                        <div id="field"></div>
                    </div>
                    
                </div>
                <div class="col-xs-12 col-md-6" id="fielder-location">
                    <h4>Spray Density</h4>
                    <div id="field-density"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}