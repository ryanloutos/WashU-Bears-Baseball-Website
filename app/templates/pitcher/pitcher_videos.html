{% extends "base.html" %}

{% block styles %}
{{ super() }}
<style>
    .video-title {
        font-size: 25px;
        text-align: center;
    }

    .video-div {
        overflow: hidden;
        display: inline-block;
        white-space: nowrap;
        padding-right: 50px;
        padding-bottom: 25px;
    }
</style>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        select_season = document.getElementById("season-selector");
        select_season.addEventListener("change", function () {
            updateVideos();
        });
        updateVideos();
    });

    function updateVideos() {
        season = select_season.value;
        pitcher = {{ pitcher.id }};
    };

    fetch(
        "/api/videos/season/" + season + "/pitcher/" + pitcher,
    ).then(res => res.json())
        .then(function (response) {
            if (response.status == "failure") {
                console.log("Request ended in failure");
                console.log("Error: " + response.error);
            } else {
                console.log("Success");
                video_ids = response.video_ids;
                video_names = response.video_names;
                document.getElementById("all-videos").innerHTML = "";
                for (var i = 0; i < video_ids.length; i++) {
                    let div = "<div class='video-div'>";
                    div += "<iframe width='352' height='198' src='https://www.youtube-nocookie.com/embed/";
                    div += video_ids[i];
                    div += "' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' allowfullscreen>";
                    div += "</iframe>";
                    div += "<div class='video-title'>";
                    div += video_names[i];
                    div += "</div></div>";
                    document.getElementById("all-videos").innerHTML += div;
                }
            }
        })
    }

</script>
{% endblock %}

{% block app_content %}
{% include "pitcher/pitcher_sidenav.html" %}
<div class="main">
    {% include "pitcher/pitcher_title.html" %}
    <h1>{{ pitcher }} - Videos</h1>
    <br>
    <div style="font-size: 20px;">
        Season:
        <select id="season-selector">
            {% for season in seasons %}
            <option value="{{ season.id }}">{{ season }}</option>
            {% endfor %}
        </select>
    </div>
    <br>
    <div id="all-videos">
        {% for video in videos %}
        <div class="video-div">
            <iframe width="352" height="198" src="https://www.youtube-nocookie.com/embed/{{video}}" frameborder="0"
                allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
            </iframe>
            <div class="video-title">{{video_objects[loop.index0]}}</div>
        </div>
        {% endfor %}
    </div>
    {% endblock %}